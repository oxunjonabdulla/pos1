{% for order in user_orders %}
    <tr>
        <td class="text-start">
            <div class="form-check form-check-sm form-check-custom form-check-solid">
                <input class="form-check-input" type="checkbox" value="1"/>
            </div>
        </td>
        <td class="text-start" data-kt-ecommerce-order-filter="order_id">
            <a href="{% url "order1-detail" pk=order.id %}"
               class="text-gray-800 text-hover-primary fw-bold">
                #{{ order.id }} </a>
        </td>
        <td>
            <div class="d-flex align-items-center">
                <!--begin:: Avatar -->
                <div class="symbol symbol-circle symbol-50px overflow-hidden me-3">
                    <a href="#">
                        <div class="symbol-label">

                            {% if order.foydalanuvchi.image  %}
                            	    <img src="{{ order.foydalanuvchi.image.url }}"
                                 alt="{{ order.foydalanuvchi.username }}" class="w-100"/>
                            {% endif %}

                        </div>
                    </a>
                </div>
                <!--end::Avatar-->

                <div class="ms-5">
                    <!--begin::Title-->
                    <span href="#"
                          class="text-gray-800 text-hover-primary fs-5 fw-bold">{{ order.foydalanuvchi.username }}</span>
                    <!--end::Title-->
                </div>
            </div>
        </td>
        <td class="text-end pe-0" data-order="Cancelled">
            <!--begin::Badges-->
            {% if order.status == '1' %}
                <div class="badge badge-light-primary">Buyurtma berildi</div>
            {% elif order.status == '2' %}
                <!--begin::Badges-->
                <div class="badge badge-light-success">Bajarildi</div>
                <!--end::Badges-->
            {% elif order.status == '3' %}
                <!--begin::Badges-->
                <div class="badge badge-light-danger">Bekor qilindi</div>

                <!--end::Badges-->
            {% endif %}
            <!--end::Badges-->
        </td>
        <td class="text-end pe-0">
            <span class="fw-bold">{{ order.jami_maxsulot }} ta</span>
        </td>
        <td class="text-end" data-order="{{ order.created_at }}">
            <span class="fw-bold">{{ order.created_at }}</span>
        </td>
        <td class="text-end" data-order="{{ order.updated_at }}">
            <span class="fw-bold">{{ order.updated_at }}</span>
        </td>
        <td class="text-end">
            <a href="{% url "order1-detail" pk=order.id %}"
               class="btn btn-sm btn-light btn-flex btn-center btn-active-light-primary"
               data-kt-menu-trigger="click" data-kt-menu-placement="bottom-end">
                Batafsil
            </a>
            <!--begin::Menu-->
            <!--end::Menu-->                </td>
    </tr>
{% endfor %}

<script>
    document.addEventListener('DOMContentLoaded', function () {
        const searchInput = document.querySelector('[data-kt-ecommerce-order-filter="search"]');
        const tableBody = document.querySelector('#order-table-body');

        searchInput.addEventListener('input', function () {
            const query = searchInput.value;

            fetch(`/search-orders/?q=${encodeURIComponent(query)}`, {
                headers: {
                    'X-Requested-With': 'XMLHttpRequest'
                }
            })
                .then(response => {
                    if (!response.ok) throw new Error('Network response was not ok');
                    return response.json();
                })
                .then(data => {
                    if (data.html) {
                        tableBody.innerHTML = data.html;
                    } else if (data.error) {
                        console.error('Error:', data.error);
                    }
                })
                .catch(error => console.error('Error:', error));
        });
    });
</script>
