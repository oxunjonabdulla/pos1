{% load static %}

<!DOCTYPE html>
<html lang="uz">

<head>
    <meta charset="utf-8">
    <title>Kabinet</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content>
    <meta name="author" content>

    <link href="{% static 'assets/css/vendor.min.css' %}" rel="stylesheet">
    <link href="{% static 'assets/css/app.min.css' %}" rel="stylesheet">

</head>
<body class="pace-top">

<div id="app" class="app app-content-full-height app-without-sidebar app-without-header">
    <div id="content" class="app-content p-0">

        <div class="pos pos-with-menu pos-with-sidebar" id="pos">
            <div class="pos-container">

                <div class="pos-menu">

                    <div class="logo">
                        <a href="{% url 'home_page' %}">
                            <div class="logo-img" style="height: 5rem;">
                                <img src="{% static 'custom/logo.png' %}">
                            </div>
                            <div class="logo-text">{{ site_settings.brand_name }}</div>
                        </a>
                    </div>


                    <div class="nav-container">
                        <div class="h-100" data-scrollbar="true" data-skip-mobile="true">
                            <ul class="nav nav-tabs">
                                <li class="nav-item">
                                    <a class="nav-link" href="{% url 'home_page' %}">
                                        <i class="fa-solid fa-house"></i> Bosh sahifa
                                    </a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link active" href="{% url 'profile_page' %}">
                                        <i class="fa-solid fa-user"></i> Kabinet
                                    </a>
                                </li>
                                <li class="nav-item" onclick="logoutConfirm()">
                                    <a class="nav-link" href="#">
                                        <i class="fa-solid fa-right-from-bracket"></i> Chiqish
                                    </a>
                                </li>
                            </ul>
                        </div>
                    </div>

                </div>

                <div class="pos-content">
                    <div class="pos-content-container h-100">
                        <div class="row gx-4">
                            <div class="profile">

                                <div class="profile-header">
                                    <div class="profile-header-cover"></div>
                                    <div class="profile-header-content">
                                        <div class="profile-header-img">
                                            {% if request.user.image %}
                                                <img src="{{ request.user.image.url }}" alt="">
                                            {% endif %}
                                        </div>
                                    </div>
                                </div>


                                <div class="profile-container">

                                    <div class="profile-sidebar">
                                        <div class="desktop-sticky-top">

                                            <h4 style="text-align: center">Rol : {{ request.user.role }}</h4>
                                            <br>
                                            <div class="fw-500 mb-3 text-muted mt-n2">Username
                                                : {{ request.user.username }}</div>

                                            <div class="mb-1">
                                                <i class="fa fa-map-marker-alt fa-fw text-muted"></i> {{ request.user.location }}
                                            </div>
                                        </div>
                                    </div>

                                </div>

                                <div class="profile-content">
                                    <div class="row">
                                        <div id="content" class="app-content p-0">
                                            <div class="d-flex justify-content-between mb-3">
                                                <div class="mx-1">
                                                    <h1 class="page-header mb-0">Barcha buyurtmalarim:</h1>
                                                </div>
                                                <div class="mt-md-0 mt-2"></div>
                                            </div>
                                            <div class="card">
                                                <ul class="nav nav-tabs nav-tabs-v2 px-4" role="tablist">
                                                    <li class="nav-item me-3" role="presentation">
                                                        <a href="#barchasi" class="nav-link px-2 active fw-bold"
                                                           data-bs-toggle="tab" aria-selected="true"
                                                           role="tab">Barchasi</a>
                                                    </li>
                                                    <li class="nav-item me-3" role="presentation">
                                                        <a href="#buyurtmaBerilgan"
                                                           class="nav-link px-2 text-warning fw-bold"
                                                           data-bs-toggle="tab" aria-selected="false" role="tab"
                                                           tabindex="-1">Buyurtma berilgan</a>
                                                    </li>
                                                    <li class="nav-item me-3" role="presentation">
                                                        <a href="#yetqazibBerilgan"
                                                           class="nav-link px-2 text-success fw-bold"
                                                           data-bs-toggle="tab" aria-selected="false" role="tab"
                                                           tabindex="-1">Yetkazib berilgan</a>
                                                    </li>
                                                    <li class="nav-item me-3" role="presentation">
                                                        <a href="#bekorQilingan"
                                                           class="nav-link px-2 text-danger fw-bold"
                                                           data-bs-toggle="tab" aria-selected="false" role="tab"
                                                           tabindex="-1">Bekor qilingan</a>
                                                    </li>
                                                </ul>

                                                <div class="tab-content p-4">


                                                    <div class="tab-pane fade active show" id="barchasi"
                                                         role="tabpanel">

                                                        <div class="input-group mb-4">
                                                            <div class="flex-fill position-relative">
                                                                <div class="input-group">
                                                                    <input type="text" class="form-control ps-35px"
                                                                           placeholder="Buyurtmalarni saralash">
                                                                    <div class="input-group-text position-absolute top-0 bottom-0 bg-none border-0"
                                                                         style="z-index: 1020;">
                                                                        <i class="fa fa-search opacity-5"></i>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>

                                                        <div class="table-responsive">
                                                            <table class="table table-hover text-nowrap">
                                                                <thead>
                                                                <tr>
                                                                    <th class="border-top-0 pt-0 pb-2">Buyurtma ID:</th>
                                                                    <th class="border-top-0 pt-0 pb-2">Maxsulotlar</th>
                                                                    <th class="border-top-0 pt-0 pb-2">Jami soni</th>
                                                                    <th class="border-top-0 pt-0 pb-2">Xolati</th>
                                                                </tr>
                                                                </thead>
                                                                <tbody>
                                                                {% for order in user_orders %}
                                                                    <tr>
                                                                        <td class="align-middle">
                                                                            <a href="{% url 'order_detail_page' pk=order.id %}">#00{{ order.id }}</a>
                                                                        </td>
                                                                        <td class="align-middle">
                                                                            {% for i in order.maxsulotlar.all %}
                                                                                {{ i }},<br>
                                                                            {% endfor %}
                                                                        </td>
                                                                        <td class="align-middle">{{ order.jami_maxsulot }}ta</td>
                                                                        <td class="py-1 align-middle">
                                                                            {% if order.status == '1' %}
                                                                                <span class="badge bg-warning text-teal-800 bg-opacity-25 px-2 pt-5px pb-5px rounded fs-12px
                                                                                d-inline-flex align-items-center">
                                                                                <i class="fa fa-circle text-warning fs-9px fa-fw me-5px"></i> Buyurtma berilgan
                                                                            </span>
                                                                                                                                {% elif order.status == '2' %}
                                                                                                                                    <span class="badge bg-teal text-teal-800 bg-opacity-25 px-2 pt-5px pb-5px rounded fs-12px
                                                                                d-inline-flex align-items-center">
                                                                                <i class="fa fa-circle text-teal fs-9px fa-fw me-5px"></i> Yetkazib berildi
                                                                            </span>
                                                                                                                                {% elif order.status == '3' %}
                                                                                                                                    <span class="badge bg-danger text-danger-800 bg-opacity-25 px-2 pt-5px pb-5px rounded fs-12px
                                                                                d-inline-flex align-items-center">
                                                                                <i class="fa fa-circle text-danger fs-9px fa-fw me-5px"></i> Bekor qilindi
                                                                            </span>
                                                                            {% endif %}
                                                                        </td>
                                                                    </tr>
                                                                {% endfor %}
                                                                </tbody>
                                                            </table>
                                                        </div>

                                                        <!-- Pagination -->
                                                        <div class="d-flex justify-content-between align-items-center mt-3">
                                                            <div class="text-muted">
                                                                Buyurtmalarni {{ user_orders.start_index }}
                                                                dan {{ user_orders.end_index }} gacha,
                                                                jami {{ user_orders.paginator.count }} ta buyurtma
                                                            </div>
                                                            <nav aria-label="Page navigation">
                                                                <ul class="pagination">
                                                                    {% if user_orders.has_previous %}
                                                                        <li class="page-item">
                                                                            <a class="page-link" href="?page=1"
                                                                               aria-label="First">
                                                                                <span aria-hidden="true">&laquo;&laquo;</span>
                                                                            </a>
                                                                        </li>
                                                                        <li class="page-item">
                                                                           <a class="page-link" href="?section=all&page={{ user_orders.previous_page_number }}" aria-label="Previous">
{#                                                                            <a class="page-link"#}
{#                                                                               href="?page={{ user_orders.previous_page_number }}"#}
{#                                                                               aria-label="Previous">#}
                                                                                <span aria-hidden="true">&laquo;</span>
                                                                            </a>
                                                                        </li>
                                                                    {% endif %}

                                                                    {% for num in user_orders.paginator.page_range %}
                                                                        {% if user_orders.number == num %}
                                                                            <li class="page-item active"><span
                                                                                    class="page-link">{{ num }}</span>
                                                                            </li>
                                                                        {% elif num > user_orders.number|add:'-2' and num < user_orders.number|add:'2' %}
                                                                            <li class="page-item"><a class="page-link"
                                                                                                     href="?page={{ num }}">{{ num }}</a>
                                                                            </li>
                                                                        {% endif %}
                                                                    {% endfor %}

                                                                    {% if user_orders.has_next %}
                                                                        <li class="page-item">
                                                                            <a class="page-link"
                                                                               href="?page={{ user_orders.next_page_number }}"
                                                                               aria-label="Next">
                                                                                <span aria-hidden="true">&raquo;</span>
                                                                            </a>
                                                                        </li>
                                                                        <li class="page-item">
                                                                            <a class="page-link"
                                                                               href="?page={{ user_orders.paginator.num_pages }}"
                                                                               aria-label="Last">
                                                                                <span aria-hidden="true">&raquo;&raquo;</span>
                                                                            </a>
                                                                        </li>
                                                                    {% endif %}
                                                                </ul>
                                                            </nav>
                                                        </div>
                                                    </div>

                                                    <!-- Buyurtma berilgan tab -->
                                                    <div class="tab-pane fade" id="buyurtmaBerilgan" role="tabpanel">

                                                        <div class="input-group mb-4">
                                                            <div class="flex-fill position-relative">
                                                                <div class="input-group">
                                                                    <input type="text" class="form-control ps-35px"
                                                                           placeholder="Buyurtmalarni saralash">
                                                                    <div class="input-group-text position-absolute top-0 bottom-0 bg-none border-0"
                                                                         style="z-index: 1020;">
                                                                        <i class="fa fa-search opacity-5"></i>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>

                                                        <div class="table-responsive">
                                                            <table class="table table-hover text-nowrap">
                                                                <thead>
                                                                <tr>
                                                                    <th class="border-top-0 pt-0 pb-2">Buyurtma ID:</th>
                                                                    <th class="border-top-0 pt-0 pb-2">Maxsulotlar</th>
                                                                    <th class="border-top-0 pt-0 pb-2">Jami soni</th>
                                                                    <th class="border-top-0 pt-0 pb-2">Xolati</th>
                                                                </tr>
                                                                </thead>
                                                                <tbody>
                                                                {% for order in user_orders_1 %}
                                                                    <tr>
                                                                        <td class="align-middle">
                                                                            <a href="{% url 'order_detail_page' pk=order.id %}">#00{{ order.id }}</a>
                                                                        </td>
                                                                        <td class="align-middle">
                                                                            {% for i in order.maxsulotlar.all %}
                                                                                {{ i }},<br>
                                                                            {% endfor %}
                                                                        </td>
                                                                        <td class="align-middle">{{ order.jami_maxsulot }}ta</td>
                                                                        <td class="py-1 align-middle">
                                                                                <span class="badge bg-warning text-teal-800 bg-opacity-25 px-2 pt-5px pb-5px rounded fs-12px d-inline-flex align-items-center">
                                                                                    <i class="fa fa-circle text-warning fs-9px fa-fw me-5px"></i> Buyurtma berilgan
                                                                                </span>
                                                                        </td>
                                                                    </tr>
                                                                {% endfor %}
                                                                </tbody>
                                                            </table>
                                                        </div>

                                                        <!-- Pagination -->
                                                        <div class="d-flex justify-content-between align-items-center mt-3">
                                                            <div class="text-muted">
                                                                Buyurtmalarni {{ user_orders_1.start_index }}
                                                                dan {{ user_orders_1.end_index }} gacha,
                                                                jami {{ user_orders_1.paginator.count }} ta buyurtma
                                                            </div>
                                                            <nav aria-label="Page navigation">
                                                                <ul class="pagination">
                                                                    {% if user_orders_1.has_previous %}
                                                                        <li class="page-item">
                                                                            <a class="page-link" href="?page_1=1"
                                                                               aria-label="First">
                                                                                <span aria-hidden="true">&laquo;&laquo;</span>
                                                                            </a>
                                                                        </li>
                                                                        <li class="page-item">
{#                                                                            <a class="page-link"#}
{#                                                                               href="?page_1={{ user_orders_1.previous_page_number }}"#}
{#                                                                               aria-label="Previous">#}
                                                                            <a class="page-link" href="?section=delivered&page={{ user_orders.previous_page_number }}" aria-label="Previous">

                                                                                <span aria-hidden="true">&laquo;</span>
                                                                            </a>
                                                                        </li>
                                                                    {% endif %}

                                                                    {% for num in user_orders_1.paginator.page_range %}
                                                                        {% if user_orders_1.number == num %}
                                                                            <li class="page-item active"><span
                                                                                    class="page-link">{{ num }}</span>
                                                                            </li>
                                                                        {% elif num > user_orders_1.number|add:'-2' and num < user_orders_1.number|add:'2' %}
                                                                            <li class="page-item"><a class="page-link"
                                                                                                     href="?page_1={{ num }}">{{ num }}</a>
                                                                            </li>
                                                                        {% endif %}
                                                                    {% endfor %}

                                                                    {% if user_orders_1.has_next %}
                                                                        <li class="page-item">
                                                                            <a class="page-link"
                                                                               href="?page_1={{ user_orders_1.next_page_number }}"
                                                                               aria-label="Next">
                                                                                <span aria-hidden="true">&raquo;</span>
                                                                            </a>
                                                                        </li>
                                                                        <li class="page-item">
                                                                            <a class="page-link"
                                                                               href="?page_1={{ user_orders_1.paginator.num_pages }}"
                                                                               aria-label="Last">
                                                                                <span aria-hidden="true">&raquo;&raquo;</span>
                                                                            </a>
                                                                        </li>
                                                                    {% endif %}
                                                                </ul>
                                                            </nav>
                                                        </div>
                                                    </div>


                                                    <div class="tab-pane fade" id="yetqazibBerilgan" role="tabpanel">

                                                        <div class="input-group mb-4">
                                                            <div class="flex-fill position-relative">
                                                                <div class="input-group">
                                                                    <input type="text" class="form-control ps-35px"
                                                                           placeholder="Buyurtmalarni saralash">
                                                                    <div class="input-group-text position-absolute top-0 bottom-0 bg-none border-0"
                                                                         style="z-index: 1020;">
                                                                        <i class="fa fa-search opacity-5"></i>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>

                                                        <div class="table-responsive">
                                                            <table class="table table-hover text-nowrap">
                                                                <thead>
                                                                <tr>
                                                                    <th class="border-top-0 pt-0 pb-2">Buyurtma ID:</th>
                                                                    <th class="border-top-0 pt-0 pb-2">Maxsulotlar</th>
                                                                    <th class="border-top-0 pt-0 pb-2">Jami soni</th>
                                                                    <th class="border-top-0 pt-0 pb-2">Xolati</th>
                                                                </tr>
                                                                </thead>
                                                                <tbody>
                                                                {% for order in user_orders_2 %}
                                                                    <tr>
                                                                        <td class="align-middle">
                                                                            <a href="{% url 'order_detail_page' pk=order.id %}">#00{{ order.id }}</a>
                                                                        </td>
                                                                        <td class="align-middle">
                                                                            {% for i in order.maxsulotlar.all %}
                                                                                {{ i }},<br>
                                                                            {% endfor %}
                                                                        </td>
                                                                        <td class="align-middle">{{ order.jami_maxsulot }}ta</td>
                                                                        <td class="py-1 align-middle">
                                                                            {% if order.status == '1' %}
                                                                                <span class="badge bg-warning text-teal-800 bg-opacity-25 px-2 pt-5px pb-5px rounded fs-12px d-inline-flex align-items-center">
                                <i class="fa fa-circle text-warning fs-9px fa-fw me-5px"></i> Buyurtma berilgan
                            </span>
                                                                            {% elif order.status == '2' %}
                                                                                <span class="badge bg-teal text-teal-800 bg-opacity-25 px-2 pt-5px pb-5px rounded fs-12px d-inline-flex align-items-center">
                                <i class="fa fa-circle text-teal fs-9px fa-fw me-5px"></i> Yetkazib berildi
                            </span>
                                                                            {% elif order.status == '3' %}
                                                                                <span class="badge bg-danger text-teal-800 bg-opacity-25 px-2 pt-5px pb-5px rounded fs-12px d-inline-flex align-items-center">
                                <i class="fa fa-circle text-teal fs-9px fa-fw me-5px"></i> Bekor qilindi
                            </span>
                                                                            {% endif %}
                                                                        </td>

                                                                    </tr>
                                                                {% endfor %}
                                                                </tbody>
                                                            </table>
                                                        </div>

                                                        <!-- Pagination -->
                                                        <div class="d-flex justify-content-between align-items-center mt-3">
                                                            <div class="text-muted">
                                                                Buyurtmalarni {{ user_orders_2.start_index }}
                                                                dan {{ user_orders_2.end_index }} gacha,
                                                                jami {{ user_orders_2.paginator.count }} ta buyurtma
                                                            </div>
                                                            <nav aria-label="Page navigation">
                                                                <ul class="pagination">
                                                                    {% if user_orders_2.has_previous %}
                                                                        <li class="page-item">
                                                                            <a class="page-link" href="?page_2=1"
                                                                               aria-label="First">
                                                                                <span aria-hidden="true">&laquo;&laquo;</span>
                                                                            </a>
                                                                        </li>
                                                                        <li class="page-item">
{#                                                                            <a class="page-link"#}
{#                                                                               href="?page_2={{ user_orders_2.previous_page_number }}"#}
{#                                                                               aria-label="Previous">#}
                                                                            <a class="page-link" href="?section=shipped&page={{ user_orders.previous_page_number }}"
                                                                               aria-label="Previous">

                                                                                <span aria-hidden="true">&laquo;</span>
                                                                            </a>
                                                                        </li>
                                                                    {% endif %}

                                                                    {% for num in user_orders_2.paginator.page_range %}
                                                                        {% if user_orders_2.number == num %}
                                                                            <li class="page-item active"><span
                                                                                    class="page-link">{{ num }}</span>
                                                                            </li>
                                                                        {% elif num > user_orders_2.number|add:'-2' and num < user_orders_2.number|add:'2' %}
                                                                            <li class="page-item"><a class="page-link"
                                                                                                     href="?page_2={{ num }}">{{ num }}</a>
                                                                            </li>
                                                                        {% endif %}
                                                                    {% endfor %}

                                                                    {% if user_orders_2.has_next %}
                                                                        <li class="page-item">
                                                                            <a class="page-link"
                                                                               href="?page_2={{ user_orders_2.next_page_number }}"
                                                                               aria-label="Next">
                                                                                <span aria-hidden="true">&raquo;</span>
                                                                            </a>
                                                                        </li>
                                                                        <li class="page-item">
                                                                            <a class="page-link"
                                                                               href="?page_2={{ user_orders_2.paginator.num_pages }}"
                                                                               aria-label="Last">
                                                                                <span aria-hidden="true">&raquo;&raquo;</span>
                                                                            </a>
                                                                        </li>
                                                                    {% endif %}
                                                                </ul>
                                                            </nav>
                                                        </div>

                                                    </div>

                                                    <div class="tab-pane fade" id="bekorQilingan" role="tabpanel">

                                                        <div class="input-group mb-4">
                                                            <div class="flex-fill position-relative">
                                                                <div class="input-group">
                                                                    <input type="text" class="form-control ps-35px"
                                                                           placeholder="Buyurtmalarni saralash">
                                                                    <div class="input-group-text position-absolute top-0 bottom-0 bg-none border-0"
                                                                         style="z-index: 1020;">
                                                                        <i class="fa fa-search opacity-5"></i>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>

                                                        <div class="table-responsive">
                                                            <table class="table table-hover text-nowrap">
                                                                <thead>
                                                                <tr>
                                                                    <th class="border-top-0 pt-0 pb-2">Buyurtma ID:</th>
                                                                    <th class="border-top-0 pt-0 pb-2">Maxsulotlar</th>
                                                                    <th class="border-top-0 pt-0 pb-2">Jami soni</th>
                                                                    <th class="border-top-0 pt-0 pb-2">Xolati</th>
                                                                </tr>
                                                                </thead>
                                                                <tbody>
                                                                {% for order in user_orders_3 %}
                                                                    <tr>
                                                                        <td class="align-middle">
                                                                            <a href="{% url 'order_detail_page' pk=order.id %}">#00{{ order.id }}</a>
                                                                        </td>
                                                                        <td class="align-middle">
                                                                            {% for i in order.maxsulotlar.all %}
                                                                                {{ i }},<br>
                                                                            {% endfor %}
                                                                        </td>
                                                                        <td class="align-middle">{{ order.jami_maxsulot }}ta</td>
                                                                        <td class="py-1 align-middle">
                                                                            {% if order.status == '1' %}
                                                                                <span class="badge bg-warning text-teal-800 bg-opacity-25 px-2 pt-5px pb-5px rounded fs-12px d-inline-flex align-items-center">
                                    <i class="fa fa-circle text-warning fs-9px fa-fw me-5px"></i> Buyurtma berilgan
                                </span>
                                                                            {% elif order.status == '2' %}
                                                                                <span class="badge bg-teal text-teal-800 bg-opacity-25 px-2 pt-5px pb-5px rounded fs-12px d-inline-flex align-items-center">
                                    <i class="fa fa-circle text-teal fs-9px fa-fw me-5px"></i> Yetkazib berildi
                                </span>
                                                                            {% elif order.status == '3' %}
                                                                                <span class="badge bg-danger text-danger-800 bg-opacity-25 px-2 pt-5px pb-5px rounded fs-12px d-inline-flex align-items-center">
                                    <i class="fa fa-circle text-danger fs-9px fa-fw me-5px"></i> Bekor qilindi
                                </span>
                                                                            {% endif %}
                                                                        </td>
                                                                    </tr>
                                                                {% endfor %}
                                                                </tbody>
                                                            </table>
                                                        </div>

                                                        <!-- Pagination -->
                                                        <div class="d-flex justify-content-between align-items-center mt-3">
                                                            <div class="text-muted">
                                                                Buyurtmalarni {{ user_orders_3.start_index }}
                                                                dan {{ user_orders_3.end_index }} gacha,
                                                                jami {{ user_orders_3.paginator.count }} ta buyurtma
                                                            </div>
                                                            <nav aria-label="Page navigation">
                                                                <ul class="pagination">
                                                                    {% if user_orders_3.has_previous %}
                                                                        <li class="page-item">
                                                                            <a class="page-link" href="?page_3=1"
                                                                               aria-label="First">
                                                                                <span aria-hidden="true">&laquo;&laquo;</span>
                                                                            </a>
                                                                        </li>
                                                                        <li class="page-item">
{#                                                                            <a class="page-link"#}
{#                                                                               href="?page_3={{ user_orders_3.previous_page_number }}"#}
{#                                                                               aria-label="Previous">#}

                                                                            <a class="page-link" href="?section=canceled&page={{ user_orders.previous_page_number }}" aria-label="Previous">

                                                                                <span aria-hidden="true">&laquo;</span>
                                                                            </a>
                                                                        </li>
                                                                    {% endif %}

                                                                    {% for num in user_orders_3.paginator.page_range %}
                                                                        {% if user_orders_3.number == num %}
                                                                            <li class="page-item active"><span
                                                                                    class="page-link">{{ num }}</span>
                                                                            </li>
                                                                        {% elif num > user_orders_3.number|add:'-2' and num < user_orders_3.number|add:'2' %}
                                                                            <li class="page-item"><a class="page-link"
                                                                                                     href="?page_3={{ num }}">{{ num }}</a>
                                                                            </li>
                                                                        {% endif %}
                                                                    {% endfor %}

                                                                    {% if user_orders_3.has_next %}
                                                                        <li class="page-item">
                                                                            <a class="page-link"
                                                                               href="?page_3={{ user_orders_3.next_page_number }}"
                                                                               aria-label="Next">
                                                                                <span aria-hidden="true">&raquo;</span>
                                                                            </a>
                                                                        </li>
                                                                        <li class="page-item">
                                                                            <a class="page-link"
                                                                               href="?page_3={{ user_orders_3.paginator.num_pages }}"
                                                                               aria-label="Last">
                                                                                <span aria-hidden="true">&raquo;&raquo;</span>
                                                                            </a>
                                                                        </li>
                                                                    {% endif %}
                                                                </ul>
                                                            </nav>
                                                        </div>

                                                    </div>

                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                            </div>
                        </div>
                    </div>
                </div>

                <div class="pos-sidebar" id="pos-sidebar">
                    <div class="h-100 d-flex flex-column p-0">

                        <div class="pos-sidebar-header">
                            <div class="back-btn">
                                <button type="button" data-toggle-class="pos-mobile-sidebar-toggled"
                                        data-toggle-target="#pos" class="btn">
                                    <i class="fa fa-chevron-left"></i>
                                </button>
                            </div>
                            <div class="icon"><i class="fa fa-plate-wheat"></i></div>
                            <div class="title">Savatcha</div>
                            <div class="order">Buyurtma: <span class="fw-bold"><b>#00{{ order_id }}</b></span></div>
                        </div>

                        <div class="pos-sidebar-body tab-content" data-scrollbar="true" data-height="100%">

                            <div class="tab-pane fade h-100 show active" id="newOrderTab">
                                {% for item in cart_items %}
                                    <div class="pos-order">
                                        <div class="pos-order-product">
                                            <div class="img"
                                                 style="background-image: url('{{ item.maxsulot.rasm.url }}')"></div>
                                            <div class="flex-1">
                                                <div class="h6 mb-1">{{ item.maxsulot.nomi }}</div>
                                                <div class="small mb-2">{{ item.maxsulot.qoshimcha }}</div>
{#                                                <div class="d-flex">#}
{#                                                    <a href="#" class="btn btn-secondary btn-sm"><i#}
{#                                                            class="fa fa-minus"></i></a>#}
{#                                                    <input disabled type="text"#}
{#                                                           class="form-control w-50px form-control-sm mx-2 bg-white bg-opacity-25 bg-white bg-opacity-25 text-center"#}
{#                                                           value="{{ item.soni }}" id="quantity_{{ item.id }}">#}
{#                                                    <a href="#" class="btn btn-secondary btn-sm ml-1"><i#}
{#                                                            class="fa fa-plus"></i></a>#}
{#                                                    <!--                                                    <a href="#" class="btn btn-theme btn-sm"><i class="fa-solid fa-rotate"></i></a>-->#}
{#                                                </div>#}

                                                 <div class="d-flex">
                                                <a href="#" class="btn btn-secondary btn-sm" onclick="decreaseQuantity('{{ item.id }}')"><i class="fa fa-minus"></i></a>
                                                <input disabled type="text"
                                                       class="form-control w-50px form-control-sm mx-2 bg-white bg-opacity-25 text-center"
                                                       value="{{ item.soni }}" id="quantity_{{ item.id }}">
                                                <a href="#" class="btn btn-secondary btn-sm ml-1" onclick="increaseQuantity('{{ item.id }}')"><i class="fa fa-plus"></i></a>
                                            </div>

                                            </div>
                                        </div>
                                        <div class="pos-order-price d-flex flex-column">
                                            <div class="flex-1">{{ item.maxsulot.razmer }}</div>
                                            <div class="text-end">
                                                <a href="#" class="btn btn-default btn-sm"
                                                   onclick="removeFromCart('{{ item.id }}')"><i class="fa fa-trash"></i></a>
                                            </div>
                                        </div>
                                    </div>
                                {% empty %}
                                    <div class="alert alert-warning rounded-0 text-center"><h4><i
                                            class="fa-solid fa-trash text-warning"></i> Savatcha bo'sh!</h4></div>
                                {% endfor %}

                            </div>

                        </div>

                        <form method="post" action="{% url 'order_page' %}" class="pos-sidebar-footer"
                              enctype="multipart/form-data">
                            {% csrf_token %}
                            <div class="mb-2">
                                <div class="form-group mb-3">
                                    <label class="form-label" for="rasmUchun">Qo'shimcha rasm(Ixtiyoriy)</label>
                                    <input type="file" name="qoshimchaRasm" accept="image/*" class="form-control"
                                           id="rasmUchun">
                                </div>
                                <div class="form-group mb-3">
                                    <label class="form-label fw-bold text-primary" for="textUchun">Qo'shimcha
                                        matn(Ixtiyoriy)</label>
                                    <textarea name="qoshimchaMatn" class="form-control" id="textUchun"
                                              rows="3"></textarea>
                                </div>
                            </div>
                            <hr>
                            <div class="d-flex align-items-center mb-2">
                                <div>Barcha tanlanganlar:</div>
                                <div class="flex-1 text-end h4 mb-0">{{ cart_item_count }}ta</div>
                            </div>
                            <div class="mt-3">
                                <div class="d-flex">

                                    {% if cart_item_count == 0 %}
                                        <div onclick="alert('Savatcha bo\'sh!')"
                                             class="btn btn-danger me-10px d-flex align-items-center justify-content-center">
                                            <span>
                                                <i class="fa-solid fa-trash fa-lg my-10px d-block"></i>
                                                <span class="fw-bold">Tozalash</span>
                                            </span>
                                        </div>
                                        <div onclick="alert('Savatcha bo\'sh!')"
                                             class="btn btn-theme flex-fill d-flex align-items-center justify-content-center">
                                            <span>
                                                <i class="fa fa-cash-register fa-lg my-10px d-block"></i>
                                                <span class="fw-bold">Buyurtma berish</span>
                                            </span>
                                        </div>
                                    {% else %}
                                        <div onclick="removeAllCart()"
                                             class="btn btn-danger me-10px d-flex align-items-center justify-content-center">
                                            <span>
                                                <i class="fa-solid fa-trash fa-lg my-10px d-block"></i>
                                                <span class="fw-bold">Tozalash</span>
                                            </span>
                                        </div>
                                        <button onclick="orderConfirm()"
                                                class="btn btn-theme flex-fill d-flex align-items-center justify-content-center">
                                            <span>
                                                <i class="fa fa-cash-register fa-lg my-10px d-block"></i>
                                                <span class="fw-bold">Buyurtma berish</span>
                                            </span>
                                        </button>
                                    {% endif %}
                                </div>
                            </div>
                        </form>

                    </div>
                </div>

            </div>
        </div>


        <a href="#" class="pos-mobile-sidebar-toggler" data-toggle-class="pos-mobile-sidebar-toggled"
           data-toggle-target="#pos">
            <i class="fa fa-shopping-bag"></i>
            <span class="badge">5</span>
        </a>

    </div>


    <div class="theme-panel">
        <a href="javascript:;" data-click="theme-panel-expand" class="theme-collapse-btn"><i class="fa fa-cog"></i></a>
        <div class="theme-panel-content">
            <ul class="theme-list clearfix">
                <li><a href="javascript:;" class="bg-red" data-theme="theme-red" data-click="theme-selector"
                       data-bs-toggle="tooltip" data-bs-trigger="hover" data-bs-container="body" data-bs-title="Red"
                       data-original-title title>&nbsp;</a></li>
                <li><a href="javascript:;" class="bg-pink" data-theme="theme-pink" data-click="theme-selector"
                       data-bs-toggle="tooltip" data-bs-trigger="hover" data-bs-container="body" data-bs-title="Pink"
                       data-original-title title>&nbsp;</a></li>
                <li><a href="javascript:;" class="bg-orange" data-theme="theme-orange" data-click="theme-selector"
                       data-bs-toggle="tooltip" data-bs-trigger="hover" data-bs-container="body" data-bs-title="Orange"
                       data-original-title title>&nbsp;</a></li>
                <li><a href="javascript:;" class="bg-yellow" data-theme="theme-yellow" data-click="theme-selector"
                       data-bs-toggle="tooltip" data-bs-trigger="hover" data-bs-container="body" data-bs-title="Yellow"
                       data-original-title title>&nbsp;</a></li>
                <li><a href="javascript:;" class="bg-lime" data-theme="theme-lime" data-click="theme-selector"
                       data-bs-toggle="tooltip" data-bs-trigger="hover" data-bs-container="body" data-bs-title="Lime"
                       data-original-title title>&nbsp;</a></li>
                <li><a href="javascript:;" class="bg-green" data-theme="theme-green" data-click="theme-selector"
                       data-bs-toggle="tooltip" data-bs-trigger="hover" data-bs-container="body" data-bs-title="Green"
                       data-original-title title>&nbsp;</a></li>
                <li><a href="javascript:;" class="bg-teal" data-theme="theme-teal" data-click="theme-selector"
                       data-bs-toggle="tooltip" data-bs-trigger="hover" data-bs-container="body" data-bs-title="Teal"
                       data-original-title title>&nbsp;</a></li>
                <li><a href="javascript:;" class="bg-cyan" data-theme="theme-cyan" data-click="theme-selector"
                       data-bs-toggle="tooltip" data-bs-trigger="hover" data-bs-container="body" data-bs-title="Aqua"
                       data-original-title title>&nbsp;</a></li>
                <li class="active"><a href="javascript:;" class="bg-blue" data-theme data-click="theme-selector"
                                      data-bs-toggle="tooltip" data-bs-trigger="hover" data-bs-container="body"
                                      data-bs-title="Default" data-original-title title>&nbsp;</a></li>
                <li><a href="javascript:;" class="bg-purple" data-theme="theme-purple" data-click="theme-selector"
                       data-bs-toggle="tooltip" data-bs-trigger="hover" data-bs-container="body" data-bs-title="Purple"
                       data-original-title title>&nbsp;</a></li>
                <li><a href="javascript:;" class="bg-indigo" data-theme="theme-indigo" data-click="theme-selector"
                       data-bs-toggle="tooltip" data-bs-trigger="hover" data-bs-container="body" data-bs-title="Indigo"
                       data-original-title title>&nbsp;</a></li>
                <li><a href="javascript:;" class="bg-gray-600" data-theme="theme-gray-600" data-click="theme-selector"
                       data-bs-toggle="tooltip" data-bs-trigger="hover" data-bs-container="body" data-bs-title="Gray"
                       data-original-title title>&nbsp;</a></li>
            </ul>
            <hr class="mb-0">
            <div class="row mt-10px pt-3px">
                <div class="col-9 control-label text-body-emphasis fw-bold">
                    <div>Dark Mode <span class="badge bg-theme text-theme-color ms-1 position-relative py-4px px-6px"
                                         style="top: -1px">NEW</span></div>
                    <div class="lh-sm fs-13px fw-semibold">
                        <small class="text-body-emphasis opacity-50">
                            Adjust the appearance to reduce glare and give your eyes a break.
                        </small>
                    </div>
                </div>
                <div class="col-3 d-flex">
                    <div class="form-check form-switch ms-auto mb-0 mt-2px">
                        <input type="checkbox" class="form-check-input" name="app-theme-dark-mode" id="appThemeDarkMode"
                               value="1">
                        <label class="form-check-label" for="appThemeDarkMode">&nbsp;</label>
                    </div>
                </div>
            </div>
        </div>
    </div>


    <a href="#" data-click="scroll-top" class="btn-scroll-top fade"><i class="fa fa-arrow-up"></i></a>
</div>


<div class="modal modal-pos fade" id="modalPosItem">
    <div class="modal-dialog modal-lg">
        <div class="modal-content border-0">
            <a href="#" data-bs-dismiss="modal" class="btn-close position-absolute top-0 end-0 m-4"></a>
            <div class="modal-pos-product">
                <div class="modal-pos-product-img">
                    <div class="img" style="background-image: url('/media/maxsulotlar/fon.png')"></div>
                </div>
                <form method="post" class="modal-pos-product-info" id="addToCartForm">
                    {% csrf_token %}
                    <div class="fs-4 fw-semibold">Bolt</div>
                    <div class="text-body text-opacity-50 mb-2">
                        test lorem
                    </div>
                    <div class="fs-3 fw-bold mb-3">Razmer: 15x45</div>
                    <div class="d-flex mb-3">
                        <a href="#" class="btn btn-secondary btn-minus"><i class="fa fa-minus"></i></a>
                        <input type="text" class="form-control w-50px fw-bold mx-2 text-center" name="qty" value="1">
                        <a href="#" class="btn btn-secondary btn-plus"><i class="fa fa-plus"></i></a>
                    </div>
                    <hr class="opacity-1">
                    <div class="row">
                        <div class="col-4">
                            <a href="#" class="btn btn-default fw-semibold mb-0 d-block py-3 bekor-qilish"
                               data-bs-dismiss="modal">Bekor qilish</a>
                        </div>
                        <div class="col-8">
                            <button type="submit"
                                    class="btn btn-theme fw-semibold d-flex justify-content-center align-items-center py-3 m-0">
                                Savatchaga qo'shish <i class="fa fa-plus ms-2 my-n3"></i></button>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

<script src="{% static 'assets/js/vendor.min.js' %}" type="text/javascript"></script>
<script src="{% static 'assets/js/app.min.js' %}" type="text/javascript"></script>
<script src="{% static 'assets/js/demo/pos-customer-order.demo.js' %}" type="text/javascript"></script>

<script>
    function setProduct(id, nomi, rasm, razmer, qoshimcha) {

        let product = {
            id: id, nomi: nomi, rasm: rasm, razmer: razmer, qoshimcha: qoshimcha
        }

        // Obyektni LocalStorage'ga qo'shish
        localStorage.setItem('product', JSON.stringify(product));

        // Saqlanganligini xabar bering
        console.log('Saqlandi!!!')

        // Modal oynasi HTML elementini tanlash
        var modalPosItem = document.getElementById('modalPosItem');

        // Modal pos product nomli localStorage kalitini olish
        var localStorageKey = 'product';
        var modalPosProduct = JSON.parse(localStorage.getItem(localStorageKey)) || {};

        // Modal oynasi ichidagi mahsulot ma'lumotlarini o'rniga joylash
        modalPosItem.querySelector('.modal-pos-product-img .img').style.backgroundImage = 'url("' + modalPosProduct.rasm + '")';
        modalPosItem.querySelector('.fs-4.fw-semibold').innerText = modalPosProduct.nomi;
        modalPosItem.querySelector('.text-body.text-opacity-50.mb-2').innerText = modalPosProduct.qoshimcha;
        modalPosItem.querySelector('.fs-3.fw-bold.mb-3').innerText = 'Razmer: ' + modalPosProduct.razmer;

        var newAction = `/add-to-cart/${id}/`;

        // Form elementini sein
        var myForm = document.getElementById("addToCartForm");

        // Formun aksiyon zelliini deitirin
        myForm.action = newAction;

        // Formu manuel olarak gnderin
        // myForm.submit();

    }

    // Modal oynasi HTML elementini tanlash
    var modalPosItem = document.getElementById('modalPosItem');

    // Modal pos product nomli localStorage kalitini olish
    var localStorageKey = 'product';
    var modalPosProduct = JSON.parse(localStorage.getItem(localStorageKey)) || {};

    // Minus va plus tugmalari uchun event listenerlarni qo'shish
    modalPosItem.querySelector('.btn-minus').addEventListener('click', function () {
        updateQuantity(-1);
    });

    modalPosItem.querySelector('.btn-plus').addEventListener('click', function () {
        updateQuantity(1);
    });

    // Modal oynasi ichidagi inputni va bekor qilish tugmasini olish
    var quantityInput = modalPosItem.querySelector('input[name="qty"]');
    var cancelBtn = modalPosItem.querySelector('.bekor-qilish');

    // Inputga o'zgartirish va bekor qilish tugmalariga event listenerlarni qo'shish
    quantityInput.addEventListener('input', function () {
        updateQuantity(0); // Ixtiyoriy, inputga harakat bo'lganda ham malumotlarni yangilaymiz
    });

    cancelBtn.addEventListener('click', function () {
        closeModal();
    });

    // Mahsulot miqdorini yangilovchi funksiya
    function updateQuantity(change) {
        var currentQuantity = parseInt(quantityInput.value) || 0;
        var newQuantity = currentQuantity + change;

        // Minimum miqdorni chegaralash
        if (newQuantity < 1) {
            newQuantity = 1;
        }

        // Input qiymatini yangilash
        quantityInput.value = newQuantity;
    }

    // Modalni yopish
    function closeModal() {
        var bsModal = new bootstrap.Modal(modalPosItem);
        bsModal.hide();
    }
</script>

<script>


function updateCartQuantity(cartItemId, newQuantity) {
    fetch('/update-cart-quantity/', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
            'X-CSRFToken': getCsrfToken() // CSRF token for security
        },
        body: JSON.stringify({
            cart_item_id: cartItemId,
            new_quantity: newQuantity
        })
    })
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                console.log('Cart updated successfully!');
            } else {
                console.error('Error updating cart:', data.message);
            }
        })
        .catch(error => console.error('Error:', error));
}

function decreaseQuantity(cartItemId) {
    var quantityInput = document.getElementById('quantity_' + cartItemId);
    console.log("Ishladi");
    if (quantityInput) {
        var currentQuantity = parseInt(quantityInput.value) || 1;
        if (currentQuantity > 1) {
            var newQuantity = currentQuantity - 1;
            quantityInput.value = newQuantity;

            // Update the database
            updateCartQuantity(cartItemId, newQuantity);
        }
    }
}

function increaseQuantity(cartItemId) {
    var quantityInput = document.getElementById('quantity_' + cartItemId);
    if (quantityInput) {
        var newQuantity = parseInt(quantityInput.value) + 1;
        quantityInput.value = newQuantity;

        // Update the database
        updateCartQuantity(cartItemId, newQuantity);
    }
}

// Helper function to get CSRF token from cookies
function getCsrfToken() {
    const csrfCookie = document.cookie
        .split('; ')
        .find(row => row.startsWith('csrftoken='));
    return csrfCookie ? csrfCookie.split('=')[1] : '';
}


    function removeFromCart(itemId) {

        // rnek:
        var confirmation = confirm("Rostdan ham o'chirmoqchimisiz?");
        if (confirmation) {
            console.log("Ok")
            window.location.href = '/remove-item-cart/' + itemId + '/';
        } else {
            console.log("Qoldi")
        }
    }

    function removeAllCart() {

        // rnek:
        var confirmation = confirm("Rostdan ham tozalamoqchimisiz?");
        if (confirmation) {
            console.log("Ok")
            window.location.href = '/remove-all-cart/';
        } else {
            console.log("Qoldi")
        }
    }
</script>









<script>
    document.addEventListener("DOMContentLoaded", function () {
        // Get the input element
        var filterInput = document.querySelector(".form-control.ps-35px");

        // Add an input event listener to trigger the filtering
        filterInput.addEventListener("input", function () {
            // Get the value of the filter input
            var filterValue = filterInput.value.toLowerCase();

            // Get all rows in the table body
            var rows = document.querySelectorAll(".table tbody tr");

            // Loop through each row and hide/show based on the filter value
            rows.forEach(function (row) {
                // Get the order number cell content
                var orderNumber = row.querySelector("td:nth-child(2)").textContent.toLowerCase();

                // Check if the order number contains the filter value
                if (orderNumber.includes(filterValue)) {
                    // If it contains, show the row
                    row.style.display = "";
                } else {
                    // If it doesn't contain, hide the row
                    row.style.display = "none";
                }
            });
        });
    });
</script>

<script>
    function logoutConfirm() {
        var confirmation = confirm("Rostdan ham tizimni tark etmoqchimisiz?");
        if (confirmation) {
            console.log("Ok")
            window.location.href = '/auth/logout/';
        } else {
            console.log("Yo'q")
        }
    }
</script>


</body>
</html>
